<!DOCTYPE html>
<html>
<head>
  <title>Solidity Compiler in Browser</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    textarea { width: 100%; height: 200px; font-family: monospace; }
    pre { background: #f4f4f4; padding: 10px; border: 1px solid #ccc; white-space: pre-wrap; }
    #errors { color: red; }
    #warnings { color: orange; }
  </style>
</head>
<body>
  <h2>Solidity Compiler in Browser</h2>
  <textarea id="source">
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract HelloWorld {
    string public greeting = "Hello, world!"
}
  </textarea>
  <br>
  <button onclick="compile()">Compile</button>
  <h3>Errors</h3>
  <pre id="errors"></pre>
  <h3>Warnings</h3>
  <pre id="warnings"></pre>
  <h3>ABI</h3>
  <pre id="abi"></pre>
  <h3>Bytecode</h3>
  <pre id="bytecode"></pre>

  <script src="https://binaries.soliditylang.org/bin/soljson-latest.js"></script>
  <script>
    try{
    function loadCompiler() {
      return new Promise((resolve) => {
        window.Module = {
          onRuntimeInitialized: () => {
            const compiler = solc.setupMethods(require('solc'));
            resolve(compiler);
          }
        };
      });
    }

    async function compile() {
      const source = document.getElementById('source').value;
      const errorsEl = document.getElementById('errors');
      const warningsEl = document.getElementById('warnings');
      const abiEl = document.getElementById('abi');
      const bytecodeEl = document.getElementById('bytecode');

      errorsEl.textContent = '';
      warningsEl.textContent = '';
      abiEl.textContent = '';
      bytecodeEl.textContent = '';

      const compiler = await loadCompiler();

      const input = {
        language: 'Solidity',
        sources: {
          'MyContract.sol': { content: source }
        },
        settings: {
          outputSelection: {
            '*': {
              '*': ['abi', 'evm.bytecode']
            }
          }
        }
      };

      const output = JSON.parse(compiler.compile(JSON.stringify(input)));

      if (output.errors) {
        for (const error of output.errors) {
          if (error.severity === 'error') {
            errorsEl.textContent += error.formattedMessage + '\n';
          } else {
            warningsEl.textContent += error.formattedMessage + '\n';
          }
        }
      }

      if (!output.contracts || !output.contracts['MyContract.sol']) return;

      const contractName = Object.keys(output.contracts['MyContract.sol'])[0];
      const contract = output.contracts['MyContract.sol'][contractName];

      abiEl.textContent = JSON.stringify(contract.abi, null, 2);
      bytecodeEl.textContent = contract.evm.bytecode.object;
    }
    }catch(err){
      alert("The error is "+err);
    }
  </script>
</body>
</html>
